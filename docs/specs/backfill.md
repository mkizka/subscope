# バックフィル

ユーザーがサーバー登録する際に、レコードを作成したactorのバックフィルステータスがdirtyならバックフィルする

## バックフィルの処理手順(バージョン1)

1. actorのステータスをin-processに
2. subscribersになったユーザーのPDSからレコード一覧を取得
3. レコード一覧の中から以下のレコードを一括保存
4. バックフィルの状況はXRPCクエリ(未実装)で確認出来る。クライアントは定期的にポーリングする
5. actorのステータスをsynchronizedにする

## バックフィルステータスの定義

- dirty ... 同期されていない
- in-process ... バックフィルのバックグラウンドタスクが進行中
- synchronized ... バックフィル完了

## バックフィルのバージョン定義

今後バックフィルロジックを更新することを踏まえてバックフィルにバージョンを付与する。
actorはバックフィルステータスとバックフィル時のバージョンを保存する。現在のバージョンは1。
